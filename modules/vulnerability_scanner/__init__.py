# -*- coding: utf-8 -*-
"""
Vulnerability Scanner Module

Scans project dependencies for known security vulnerabilities
using OSV, NVD, and GitHub Security Advisories.
"""

from .models import Dependency, Vulnerability, PackageVulnerabilities, ScanResult
from .parsers import DependencyParser
from .scanner import VulnerabilityScanner
from .api_clients import OSVClient, NVDClient, GitHubAdvisoryClient

__version__ = '1.0.0'
__author__ = 'Security Analysis Team'

__all__ = [
    'VulnerabilityScanner',
    'DependencyParser',
    'Dependency',
    'Vulnerability',
    'PackageVulnerabilities',
    'ScanResult',
    'OSVClient',
    'NVDClient',
    'GitHubAdvisoryClient',
]


def quick_scan(project_path: str, use_nvd: bool = False, use_github: bool = False) -> ScanResult:
    """
    Quick vulnerability scan with default settings
    
    Args:
        project_path: Path to project directory
        use_nvd: Enable NVD API (slower, requires API key for best performance)
        use_github: Enable GitHub Advisory (requires GITHUB_TOKEN env var)
    
    Returns:
        ScanResult object with all findings
    
    Example:
        >>> from modules.vulnerability_scanner import quick_scan
        >>> result = quick_scan("./my_project")
        >>> print(f"Found {result.total_vulnerabilities} vulnerabilities")
    """
    scanner = VulnerabilityScanner(use_nvd=use_nvd, use_github=use_github)
    return scanner.scan_project(project_path)






